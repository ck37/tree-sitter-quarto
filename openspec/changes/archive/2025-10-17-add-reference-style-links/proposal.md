# Add Reference-Style Links

## Why

Reference-style links (`[text][ref]`, `[text][]`, `[text]`) are standard Pandoc Markdown syntax but currently produce ERROR nodes in the parser. Link reference definitions (`[ref]: URL`) parse correctly, but their usage in text fails. This breaks compatibility with Pandoc Markdown and prevents proper syntax highlighting in editors.

**Issue:** https://github.com/ck37/tree-sitter-quarto/issues/4

**Current behavior:**
- ✅ Link reference definitions: `[ref]: URL` parse correctly
- ✅ Inline links: `[text](URL)` parse correctly
- ❌ Explicit references: `[text][ref]` produce ERROR nodes
- ❌ Collapsed references: `[text][]` produce ERROR nodes

**Note:** Shortcut references `[text]` (without second brackets) require semantic analysis to distinguish from plain text in brackets, so they are handled by language servers rather than the grammar.

**Impact:** Users cannot use reference-style links in Quarto documents without syntax errors, forcing workarounds with inline links.

## What Changes

- Extend `link` rule in `grammar.js` to support two reference-style link patterns:
  1. **Explicit reference**: `[text][label]`
  2. **Collapsed reference**: `[text][]` (label same as text)

Note: Shortcut references `[text]` are not supported at the grammar level as they require semantic analysis (checking for matching reference definitions) and cannot be reliably distinguished from plain text in brackets at parse time.

- Add test cases covering all reference-style link variants
- Update syntax highlighting queries if needed for new AST structure

## Impact

- **Affected specs:**
  - NEW: `pandoc-links` (comprehensive link specification)

- **Affected code:**
  - `grammar.js` - Modify `link` rule (lines 628-642)
  - `test/corpus/` - Add new test file `pandoc-links.txt`
  - `src/parser.c` - Regenerated by tree-sitter
  - `src/node-types.json` - Regenerated by tree-sitter

- **Breaking changes:** None - purely additive functionality

- **Compatibility:** Maintains 100% backward compatibility with existing parsed documents
